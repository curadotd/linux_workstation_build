#!/bin/bash

# Ask for user confirmation
echo "This script will download and install the latest version of Cursor for Debian."
read -p "Do you want to proceed? (y/n): " confirm

if [[ $confirm != [yY] && $confirm != [yY][eE][sS] ]]; then
    echo "Installation cancelled."
    exit 0
fi

echo "Please download Cursor from https://www.cursor.com/"
echo "Once you've downloaded the file, place it in your $HOME/Downloads folder."
read -p "Press Enter when you've completed this step..."

# Check if the file exists in the Downloads folder
if [ ! -f "$HOME/Downloads/cursor.AppImage" ]; then
    echo "cursor.AppImage not found in $HOME/Downloads folder."
    echo "Please make sure you've downloaded the file and named it 'cursor.AppImage'."
    exit 1
fi

# Make the AppImage executable
chmod +x "$HOME/Downloads/cursor*.AppImage"

# Move the AppImage to a suitable location
sudo mv "$HOME/Downloads/cursor*.AppImage" /opt/cursor

echo "Cursor has been successfully downloaded and made executable!"

# Download the Cursor icon
echo "Downloading Cursor icon..."
wget -O cursor_icon.png "https://www.cursor.so/favicon.png"

# Create the icons directory if it doesn't exist
mkdir -p ~/.local/share/icons

# Move the icon to the appropriate location
mv cursor_icon.png ~/.local/share/icons/cursor.png

# Create a desktop entry
cat << EOF > ~/.local/share/applications/cursor.desktop
[Desktop Entry]
Name=Cursor
Exec=/opt/cursor
Icon=${HOME}/.local/share/icons/cursor.png
Type=Application
Categories=Development;
EOF

echo "A desktop entry has been created for Cursor."
echo "Cursor has been successfully installed!"
echo "You can now run Cursor by typing 'cursor' in the terminal or launching it from your application menu."

echo "Cursor has been successfully installed!"
