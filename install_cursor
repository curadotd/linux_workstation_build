#!/bin/bash

# Ask for user confirmation
echo "This script will download and install the latest version of Cursor for Debian."
read -p "Do you want to proceed? (y/n): " confirm

if [[ $confirm != [yY] && $confirm != [yY][eE][sS] ]]; then
    echo "Installation cancelled."
    exit 0
fi


# Function to check if a command exists
command_exists() {
    command -v "$1" >/dev/null 2>&1
}

# Check if wget is installed
if ! command_exists wget; then
    echo "wget is not installed. Please install it and try again."
    exit 1
fi

# Download the latest AppImage
echo "Downloading the latest Cursor AppImage..."
wget -O cursor.AppImage "https://cursor.sh/download/linux-appimage"

# Check if the download was successful
if [ $? -ne 0 ]; then
    echo "Failed to download Cursor. Please check your internet connection and try again."
    exit 1
fi

# Make the AppImage executable
chmod +x cursor.AppImage

# Move the AppImage to a suitable location (e.g., /usr/local/bin)
sudo mv cursor.AppImage /usr/local/bin/cursor

echo "Cursor has been successfully downloaded and made executable!"

# Download the Cursor icon
echo "Downloading Cursor icon..."
wget -O cursor_icon.png "https://www.cursor.so/favicon.png"

# Create the icons directory if it doesn't exist
mkdir -p ~/.local/share/icons

# Move the icon to the appropriate location
mv cursor_icon.png ~/.local/share/icons/cursor.png

# Create a desktop entry
cat << EOF > ~/.local/share/applications/cursor.desktop
[Desktop Entry]
Name=Cursor
Exec=/usr/local/bin/cursor
Icon=${HOME}/.local/share/icons/cursor.png
Type=Application
Categories=Development;
EOF

echo "A desktop entry has been created for Cursor."
echo "Cursor has been successfully installed!"
echo "You can now run Cursor by typing 'cursor' in the terminal or launching it from your application menu."

echo "Cursor has been successfully installed!"
